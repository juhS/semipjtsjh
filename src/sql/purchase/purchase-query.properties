selectListWithiName=SELECT S.SUPPLIER_CODE , C.INGREDIENT_CLASS_NAME , I.INGREDIENT_CODE , I.INGREDIENT_NAME , I.INGREDIENT_CAPACITY , I.INGREDIENT_UNIT , I.INGREDIENT_CLASS_CODE , H.HOLD_QUANTITY , H.BRANCH_CODE FROM SUPPLIER_INGREDIENT S JOIN INGREDIENT_INFO I ON (S.INGREDIENT_CODE = I.INGREDIENT_CODE) JOIN INGREDIENT_CLASSIFICATION C ON(I.INGREDIENT_CLASS_CODE = C.INGREDIENT_CLASS_CODE) JOIN BRANCH_INVEN_LIST H ON(I.INGREDIENT_CODE = H.INGREDIENT_CODE) WHERE BRANCH_CODE = ? AND UPPER(I.INGREDIENT_NAME) LIKE UPPER('%' || ? || '%')
selectListWithiCode=SELECT S.SUPPLIER_CODE , C.INGREDIENT_CLASS_NAME , I.INGREDIENT_CODE , I.INGREDIENT_NAME , I.INGREDIENT_CAPACITY , I.INGREDIENT_UNIT , I.INGREDIENT_CLASS_CODE , H.HOLD_QUANTITY , H.BRANCH_CODE FROM SUPPLIER_INGREDIENT S JOIN INGREDIENT_INFO I ON (S.INGREDIENT_CODE = I.INGREDIENT_CODE) JOIN INGREDIENT_CLASSIFICATION C ON(I.INGREDIENT_CLASS_CODE = C.INGREDIENT_CLASS_CODE) JOIN BRANCH_INVEN_LIST H ON(I.INGREDIENT_CODE = H.INGREDIENT_CODE) WHERE BRANCH_CODE = ? AND UPPER(I.INGREDIENT_CODE) LIKE UPPER('%' || ? || '%')
selectPurchaseList=SELECT BRANCH_PURCHASE_CODE, INGREDIENT_CODE, INGREDIENT_NAME, PURCHASE_QUANTITY, PURCHASE_UNIT, BRANCH_CODE FROM BRANCH_PURCHASE_HISTORY JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE BRANCH_CODE = ?
selectPCode=SELECT DISTINCT BRANCH_PURCHASE_CODE FROM BRANCH_PURCHASE_HISTORY WHERE BRANCH_CODE = ? ORDER BY BRANCH_PURCHASE_CODE DESC
listOrderByPCode=SELECT BRANCH_PURCHASE_CODE, INGREDIENT_CODE, INGREDIENT_NAME , INGREDIENT_CLASS_NAME , PURCHASE_QUANTITY, PURCHASE_UNIT , BRANCH_CODE FROM BRANCH_PURCHASE_HISTORY JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) JOIN INGREDIENT_CLASSIFICATION USING(INGREDIENT_CLASS_CODE) WHERE BRANCH_CODE = ? AND BRANCH_PURCHASE_CODE = ?
getSupList=SELECT SUPPLIER_CODE FROM SUPPLIER_INGREDIENT WHERE INGREDIENT_CODE = ?
selectNextval=SELECT SEQ_BRANCH_P_CODE.NEXTVAL FROM DUAL
selectIngredientList=SELECT S.SUPPLIER_CODE , C.INGREDIENT_CLASS_NAME , I.INGREDIENT_CODE , I.INGREDIENT_NAME , I.INGREDIENT_CAPACITY , I.INGREDIENT_UNIT , I.INGREDIENT_CLASS_CODE , H.HOLD_QUANTITY , H.BRANCH_CODE FROM SUPPLIER_INGREDIENT S JOIN INGREDIENT_INFO I ON (S.INGREDIENT_CODE = I.INGREDIENT_CODE) JOIN INGREDIENT_CLASSIFICATION C ON(I.INGREDIENT_CLASS_CODE = C.INGREDIENT_CLASS_CODE) JOIN BRANCH_INVEN_LIST H ON(I.INGREDIENT_CODE = H.INGREDIENT_CODE) WHERE BRANCH_CODE = ?
selectSupList=SELECT ROWNUM, SUPPLIER_CODE , CUSTOM_NAME , SUPPLIER_REP , SUPPLIER_ADDRESS , SUPPLIER_PHONE , SUPPLIER_NUMBER , SUPPLIER_ENROLL_DATE , SUPPLIER_EMAIL , SUPPLIER_ACCOUNT_BANK , SUPPLIER_ACCOUNT_NUM , SUPPLIER_FAX FROM SUPPLIER ORDER BY ROWNUM ASC
insertSupList=INSERT INTO SUPPLIER VALUES (?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, ?)
updateSupplier=UPDATE SUPPLIER SET CUSTOM_NAME = ?, SUPPLIER_REP = ?, SUPPLIER_PHONE = ?, SUPPLIER_ADDRESS = ?, SUPPLIER_NUMBER = ?, SUPPLIER_EMAIL = ?, SUPPLIER_ACCOUNT_BANK = ?, SUPPLIER_ACCOUNT_NUM = ?, SUPPLIER_FAX = ? WHERE SUPPLIER_CODE = ?
insertIntoDoc=INSERT INTO BRANCH_PURCHASE_DOCUMENT VALUES (SEQ_BRANCH_P_CODE.NEXTVAL, SYSDATE, ?, DEFAULT)
selectPCodeforInsert=SELECT BRANCH_PURCHASE_CODE, SUPPLIER_CODE FROM (SELECT * FROM BRANCH_PURCHASE_DOCUMENT ORDER BY BRANCH_PURCHASE_CODE DESC) WHERE ROWNUM <= ? ORDER BY BRANCH_PURCHASE_CODE
insertPList=INSERT INTO BRANCH_PURCHASE_HISTORY VALUES (?, ?, ?, ?, ?)
selectpListWithDate=SELECT TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') , INGREDIENT_CLASS_NAME , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) JOIN INGREDIENT_CLASSIFICATION USING(INGREDIENT_CLASS_CODE) WHERE BRANCH_DATE BETWEEN TO_DATE(?, 'YYYY-MM-DD HH24:MI:SS' ) AND TO_DATE(?, 'YYYY-MM-DD HH24:MI:SS') AND BRANCH_CODE = ?
selectRepiName=SELECT C.RNUM , TO_CHAR(C.BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , C.INGREDIENT_NAME , B.CNT FROM (SELECT ROWNUM RNUM , BRANCH_DATE , INGREDIENT_NAME FROM (SELECT BRANCH_DATE , INGREDIENT_NAME , ROW_NUMBER() OVER (PARTITION BY BRANCH_DATE ORDER BY BRANCH_PURCHASE_CODE DESC) AS RankNo FROM (SELECT BRANCH_DATE , BRANCH_PURCHASE_CODE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE BRANCH_CODE = ?)) A WHERE A.RankNo = 1 ORDER BY BRANCH_DATE DESC) C JOIN (SELECT BRANCH_DATE , COUNT(*) AS CNT FROM (SELECT BRANCH_DATE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE BRANCH_CODE = ?) GROUP BY BRANCH_DATE) B ON (B.BRANCH_DATE = C.BRANCH_DATE) ORDER BY RNUM
selectAllBRpList=SELECT RNUM , BRANCH_DATE , BRANCH_CODE , BRANCH_NAME , INGREDIENT_NAME , CNT FROM (SELECT BRANCH_DATE, BRANCH_CODE, BRANCH_NAME, COUNT(*) CNT FROM (SELECT TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , BRANCH_CODE , BRANCH_NAME , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) JOIN BRANCH USING(BRANCH_CODE) ) GROUP BY (BRANCH_DATE, BRANCH_CODE, BRANCH_NAME)) NATURAL JOIN (SELECT ROWNUM RNUM , BRANCH_CODE , BRANCH_DATE , INGREDIENT_NAME FROM (SELECT BRANCH_DATE , BRANCH_CODE , INGREDIENT_NAME , ROW_NUMBER() OVER (PARTITION BY BRANCH_DATE, BRANCH_CODE ORDER BY BRANCH_PURCHASE_CODE DESC) AS RankNo FROM (SELECT TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , BRANCH_PURCHASE_CODE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE))) A WHERE A.RankNo = 1 ORDER BY RNUM DESC)
deleteSupplier=DELETE FROM SUPPLIER WHERE SUPPLIER_CODE = ?
selectSupListHasOrder=SELECT  DISTINCT SUPPLIER_CODE FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) group by SUPPLIER_CODE 
SelectPuListSortBySupplier=SELECT ROWNUM, SUPPLIER_CODE, CUSTOM_NAME, INGREDIENT_NAME, CNT, ALL_PRICE, ORDER_STATUS FROM(SELECT SUPPLIER_CODE, INGREDIENT_NAME, ORDER_STATUS FROM (SELECT SUPPLIER_CODE, INGREDIENT_NAME , ORDER_STATUS , ROW_NUMBER() OVER (PARTITION BY SUPPLIER_CODE ORDER BY SUPPLIER_CODE) AS RankNo FROM (SELECT SUPPLIER_CODE , INGREDIENT_NAME , ORDER_STATUS , SUM(PURCHASE_QUANTITY) AS "PURCHASE_QUANTITY" FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'N' group by SUPPLIER_CODE, INGREDIENT_NAME, ORDER_STATUS )) WHERE RankNo = 1) JOIN (SELECT SUPPLIER_CODE, SUM(ALL_COUNT) AS "ALL_PRICE" FROM (SELECT A.SUPPLIER_CODE, A.INGREDIENT_CODE, A.INGREDIENT_NAME, A.ALL_AMOUNT, (B.NORMAL_PRICE * A.ALL_AMOUNT) AS "ALL_COUNT" FROM (SELECT SUPPLIER_CODE , INGREDIENT_CODE , INGREDIENT_NAME , SUM(PURCHASE_QUANTITY) AS "ALL_AMOUNT" FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) group by SUPPLIER_CODE, INGREDIENT_CODE, INGREDIENT_NAME order by supplier_code) A JOIN SUPPLIER_INGREDIENT B ON (A.INGREDIENT_CODE = B.INGREDIENT_CODE)) GROUP BY SUPPLIER_CODE) USING( SUPPLIER_CODE) JOIN SUPPLIER USING(SUPPLIER_CODE) JOIN (SELECT SUPPLIER_CODE, COUNT(*) CNT FROM (SELECT SUPPLIER_CODE, INGREDIENT_NAME, ORDER_STATUS , ROW_NUMBER() OVER (PARTITION BY SUPPLIER_CODE ORDER BY SUPPLIER_CODE) AS RankNo FROM (SELECT SUPPLIER_CODE , INGREDIENT_NAME , ORDER_STATUS , COUNT(*) AS "CNT" , SUM(PURCHASE_QUANTITY) AS "PURCHASE_QUANTITY" FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'N' group by SUPPLIER_CODE, INGREDIENT_NAME, ORDER_STATUS )) GROUP BY SUPPLIER_CODE) USING (SUPPLIER_CODE) ORDER BY ROWNUM, SUPPLIER_CODE
selectOneSup=SELECT ROWNUM, A.SUPPLIER_CODE, D.CUSTOM_NAME , A.INGREDIENT_CODE, A.INGREDIENT_NAME, A.PURCHASE_NUM , C.INGREDIENT_CAPACITY, C.INGREDIENT_UNIT, B.NORMAL_PRICE , (B.NORMAL_PRICE * A.PURCHASE_NUM) ALL_PRICE, A.ORDER_STATUS FROM(SELECT SUPPLIER_CODE , INGREDIENT_CODE , INGREDIENT_NAME, ORDER_STATUS, SUM(PURCHASE_QUANTITY) AS "PURCHASE_NUM" FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE SUPPLIER_CODE = ? AND ORDER_STATUS = 'N' group by SUPPLIER_CODE, INGREDIENT_CODE, INGREDIENT_NAME, ORDER_STATUS order by supplier_code) A JOIN SUPPLIER_INGREDIENT B ON (A.INGREDIENT_CODE = B.INGREDIENT_CODE) JOIN INGREDIENT_INFO C ON (B.INGREDIENT_CODE = C.INGREDIENT_CODE) JOIN SUPPLIER D ON (B.SUPPLIER_CODE = D.SUPPLIER_CODE) ORDER BY ROWNUM
selectOneIng=SELECT SUPPLIER_CODE, INGREDIENT_CODE, INGREDIENT_NAME, ALL_AMOUNT, BRANCH_CODE, BRANCH_NAME, ORDER_STATUS FROM(SELECT SUPPLIER_CODE , INGREDIENT_CODE , INGREDIENT_NAME , SUM(PURCHASE_QUANTITY) AS "ALL_AMOUNT" , BRANCH_CODE, ORDER_STATUS FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE SUPPLIER_CODE = ? AND INGREDIENT_CODE = ? AND ORDER_STATUS = 'N' group by SUPPLIER_CODE, INGREDIENT_CODE, INGREDIENT_NAME, BRANCH_CODE, ORDER_STATUS order by SUPPLIER_CODE, BRANCH_CODE) JOIN BRANCH USING(BRANCH_CODE)
selectNextValforInsert=SELECT SEQ_PURCHASE_CODE.NEXTVAL FROM DUAL
selectBranchPcode=SELECT BRANCH_PURCHASE_CODE FROM HO_PURCHASE_HISTORY WHERE PURCHASE_CODE = ?
selectBPcodePrice=SELECT A.BRANCH_DATE ,A.BRANCH_PURCHASE_CODE ,A.SUPPLIER_CODE , A.INGREDIENT_CODE , A.INGREDIENT_NAME , A.PURCHASE_AMOUNT , (A.PURCHASE_AMOUNT * B.NORMAL_PRICE) ALL_PRICE , A.BRANCH_CODE, A.ORDER_STATUS FROM (SELECT  TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') AS "BRANCH_DATE" , BRANCH_PURCHASE_CODE , SUPPLIER_CODE , INGREDIENT_CODE , INGREDIENT_NAME , SUM(PURCHASE_QUANTITY) AS "PURCHASE_AMOUNT" , ORDER_STATUS , BRANCH_CODE FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) group by SUPPLIER_CODE, INGREDIENT_CODE, INGREDIENT_NAME , BRANCH_CODE, BRANCH_DATE, BRANCH_PURCHASE_CODE, ORDER_STATUS order by SUPPLIER_CODE, BRANCH_CODE) A JOIN SUPPLIER_INGREDIENT B ON(A.INGREDIENT_CODE = B.INGREDIENT_CODE) WHERE A.ORDER_STATUS = 'N'AND A.SUPPLIER_CODE = ? ORDER BY SUPPLIER_CODE
insertRegisterHO=INSERT INTO HO_PURCHASE_HISTORY VALUES(?, ?, SYSDATE, ?, DEFAULT, '\uC870\uAC74', DEFAULT)
updateOrderStatus=UPDATE BRANCH_PURCHASE_DOCUMENT SET ORDER_STATUS = 'Y' WHERE BRANCH_PURCHASE_CODE = ?
selectHOpuList=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC
selectHOpuListDetail=SELECT PURCHASE_CODE , BRANCH_CODE , BRANCH_NAME , INGREDIENT_NAME , SUM(PURCHASE_QUANTITY) PURCHASE_QUANTITY FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND PURCHASE_CODE = ? GROUP BY ROLLUP (PURCHASE_CODE, INGREDIENT_NAME), BRANCH_CODE, BRANCH_NAME HAVING PURCHASE_CODE IS NOT NULL
selectPuListWithSupCode=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) WHERE SUPPLIER_CODE LIKE UPPER('%' || ? || '%') ORDER BY ROWNUM
selectPuListWithSupName=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) WHERE CUSTOM_NAME LIKE UPPER('%' || ? || '%') ORDER BY ROWNUM
selectSupplierWithSupName=SELECT SUPPLIER_CODE, CUSTOM_NAME, SUPPLIER_REP, SUPPLIER_PHONE, SUPPLIER_ADDRESS, SUPPLIER_NUMBER, SUPPLIER_ENROLL_DATE, SUPPLIER_EMAIL, SUPPLIER_EMAIL, SUPPLIER_ACCOUNT_BANK, SUPPLIER_ACCOUNT_NUM, SUPPLIER_FAX FROM SUPPLIER WHERE CUSTOM_NAME LIKE UPPER('%' || ? || '%') ORDER BY ROWNUM ASC
selectSupplierSupCode=SELECT SUPPLIER_CODE, CUSTOM_NAME, SUPPLIER_REP, SUPPLIER_PHONE, SUPPLIER_ADDRESS, SUPPLIER_NUMBER, SUPPLIER_ENROLL_DATE, SUPPLIER_EMAIL, SUPPLIER_EMAIL, SUPPLIER_ACCOUNT_BANK, SUPPLIER_ACCOUNT_NUM, SUPPLIER_FAX FROM SUPPLIER WHERE SUPPLIER_CODE LIKE UPPER('%' || ? || '%') ORDER BY ROWNUM ASC
selectAllBranch=SELECT BRANCH_CODE, BRANCH_NAME FROM BRANCH
selectHistoryWithbName=SELECT RNUM , BRANCH_DATE , BRANCH_CODE , BRANCH_NAME , INGREDIENT_NAME , CNT FROM (SELECT BRANCH_DATE, BRANCH_CODE, BRANCH_NAME, COUNT(*) CNT FROM (SELECT TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , BRANCH_CODE , BRANCH_NAME , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) JOIN BRANCH USING(BRANCH_CODE) ) GROUP BY (BRANCH_DATE, BRANCH_CODE, BRANCH_NAME)) NATURAL JOIN (SELECT ROWNUM RNUM , BRANCH_CODE , BRANCH_DATE , INGREDIENT_NAME FROM (SELECT BRANCH_DATE , BRANCH_CODE , INGREDIENT_NAME , ROW_NUMBER() OVER (PARTITION BY BRANCH_DATE, BRANCH_CODE ORDER BY BRANCH_PURCHASE_CODE DESC) AS RankNo FROM (SELECT TO_CHAR(BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , BRANCH_PURCHASE_CODE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE))) A WHERE A.RankNo = 1 ORDER BY RNUM DESC) WHERE BRANCH_NAME = ?
selectbNameWithbCode=SELECT BRANCH_NAME FROM BRANCH WHERE BRANCH_CODE = ?
selectRepiNameWithDate=SELECT C.RNUM , TO_CHAR(C.BRANCH_DATE, 'YYYY-MM-DD HH24:MI:SS') BRANCH_DATE , C.INGREDIENT_NAME , B.CNT FROM (SELECT ROWNUM RNUM , BRANCH_DATE , INGREDIENT_NAME FROM (SELECT BRANCH_DATE , INGREDIENT_NAME , ROW_NUMBER() OVER (PARTITION BY BRANCH_DATE ORDER BY BRANCH_PURCHASE_CODE DESC) AS RankNo FROM (SELECT BRANCH_DATE , BRANCH_PURCHASE_CODE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE BRANCH_CODE = ?)) A WHERE A.RankNo = 1 AND BRANCH_DATE BETWEEN ? AND TO_DATE(?)+1 ORDER BY BRANCH_DATE DESC) C JOIN (SELECT BRANCH_DATE , COUNT(*) AS CNT FROM (SELECT BRANCH_DATE , BRANCH_CODE , INGREDIENT_CODE , INGREDIENT_NAME , PURCHASE_QUANTITY FROM BRANCH_PURCHASE_DOCUMENT JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE BRANCH_CODE = ?) GROUP BY BRANCH_DATE) B ON (B.BRANCH_DATE = C.BRANCH_DATE) ORDER BY RNUM
selectHOpuListWithDate=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND ORDER_DATE BETWEEN TO_DATE(?) AND TO_DATE(?)+1 GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC
selectHOpuListWithDateSearch=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND ORDER_DATE BETWEEN TO_DATE(?) AND TO_DATE(?)+1 AND CUSTOM_NAME LIKE '%'||?||'%' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC
selectHOpuListWithSearch=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND CUSTOM_NAME LIKE '%'||?||'%' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC
selectHOpuListWithDateSearchCode=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND ORDER_DATE BETWEEN TO_DATE(?) AND TO_DATE(?)+1 AND SUPPLIER_CODE LIKE UPPER('%'||?||'%') GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC
selectHOpuListWithSearchCode=SELECT ROWNUM , PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , ORDER_DATE FROM(SELECT PURCHASE_CODE , SUPPLIER_CODE , CUSTOM_NAME , TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER_DATE FROM HO_PURCHASE_HISTORY JOIN BRANCH_PURCHASE_DOCUMENT USING(BRANCH_PURCHASE_CODE) JOIN SUPPLIER USING (SUPPLIER_CODE) JOIN BRANCH_PURCHASE_HISTORY USING(BRANCH_PURCHASE_CODE) JOIN BRANCH USING(BRANCH_CODE) JOIN INGREDIENT_INFO USING(INGREDIENT_CODE) WHERE ORDER_STATUS = 'Y' AND SUPPLIER_CODE LIKE '%'||?||'%' GROUP BY PURCHASE_CODE, SUPPLIER_CODE, CUSTOM_NAME, TO_CHAR(ORDER_DATE,'YY-MM-DD HH24:MI:SS') ORDER BY PURCHASE_CODE) ORDER BY ROWNUM DESC